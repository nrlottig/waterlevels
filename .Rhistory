dat_cations <- CaMg %>% select(WBIC,CaConcentration,MgConcentration) %>%
mutate(cation_ratio = CaConcentration/MgConcentration)
dat <- dat %>% left_join(dat_cations)
#get Conductivity data
Conductivity_final <- read_csv("data/Conductivity_final.csv")
dat_cond <- Conductivity_final %>% select(WBIC,final_value) %>% rename(cond=final_value)
dat <- dat %>% left_join(dat_cond)
#get elevation data
lake_elevation <- read_excel("data/seepage_lake_shed_elev.xlsx")
dat_elevation <- lake_elevation %>% select(WBIC,lake_MEAN,watershed_MIN,watershed_MAX,watershed_MEAN,elevation_difference)
dat <- dat %>% left_join(dat_elevation)
#get process data
HLM_out <- read_csv("GW_Models/HLM_out.csv") %>% rename(process_slope=slope)
dat <- dat %>% left_join(HLM_out)
#get HUC data
lagoscrosswalk <- read_csv("lagoscrosswalk.csv") %>% select(WIBIC,lagoslakeid,County) %>%
rename(WBIC=WIBIC)
lagoscrosswalk <- lagoscrosswalk[!duplicated(lagoscrosswalk$WBIC),]
dat <- dat %>% left_join(lagoscrosswalk)
#get ecoregion data
regression_coefs_20180328_eco_land <- read_excel("data/regression_coefs_20180328_eco_land.xlsx")
regression_coefs_20180328_eco_land <- regression_coefs_20180328_eco_land[!duplicated(regression_coefs_20180328_eco_land$WBIC),] %>%
select(-WiscID)
dat <- dat %>% left_join(regression_coefs_20180328_eco_land)
#cleanup data
rm(list=setdiff(ls(), "dat"))
refcols <- c("WBIC",
"WiscID",
"lagoslakeid",
"County",
"LakeName",
"US_L3NAME",
"ECO_LANDSC")
respcols <- c("slope",
"n.points",
"sd.slope",
"mape",
"Gnet",
"process_slope")
dat <- dat[,c(refcols,respcols,setdiff(names(dat),c(refcols,respcols)))]
write_csv(dat,"data/ecocontext.csv")
####Original Data
dat.gnet <- read_csv("data/Gnet_slopes.csv")
eco <- read_csv("data/ecocontext.csv")
dat.gnet <- dat.gnet %>% left_join(eco)
dat.gnet$WBIC <- factor(dat.gnet$WBIC,levels=dat.gnet$WBIC[order(dat.gnet$mean)])
dat.gnet <- dat.gnet %>% mutate(slope_group = as.numeric(slope_group)) %>%
mutate(slope_group = replace(slope_group,which(mean < -1.626692 & slope_group==0),2))
ggplot(data = dat.gnet,aes(x=WBIC,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WBIC",y="Gnet (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
View(dat.gnet)
ggsave(filename = "graphics/gnet_by_gnet.png",units = "in",dpi = 300,width=8,height=5)
library(ggmap)
install.packages("ggmap")
install.packages("maps")
install.packages("mapdata")
library(ggmap)
library(maps)
library(mapdata)
?map_data
WI <- map_data("WI")
WI <- map_data("wi")
WI <- map_data("wisconsin")
WI <- map_data("state")
WI <- map_data(region = "wisconsin")
WI <- map_data(map = "state",region = "wisconsin")
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "red") +
coord_fixed(1.3)
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3)
EcoContext <- read_excel("RFModels/EcoContext.xlsx")
regressionstats <- read_csv("BayHModels/regressionstats.csv")
dat = EcoContext %>% left_join(regressionstats) %>%
dplyr::select(-ID,-OBJECTID,-WATERBODY_NAME,-HYDROID,-HYDROCODE,
-HYDROTYPE,-LANDLOCK_C,-Area,-WatershedA,
-County,-MeanDepth,-problem,-hydro24k,-centroid_x,
-centroid_y,-NATURAL_COMMUNITY,-Lake_type,-HYDROLOGY,
-`Katie classification`,-`Katie notes`,-W_LAT)
#remove parameters that have significant number of zeros
dat <- dat %>% mutate(bedrock = W_BD_202+W_BD_203+W_BD_204+W_BD_205) %>%
mutate(develop= W_LU06_21+W_LU06_22+W_LU06_23+W_LU06_24) %>%
mutate(forest = W_LU06_41+W_LU06_42+W_LU06_43) %>%
mutate(ag = W_LU06_81+W_LU06_82) %>%
mutate(SDI = SHAPE_LEN/(2*sqrt(pi*SHAPE_AREA))) %>%
mutate(forest = W_LU06_41+W_LU06_42+W_LU06_43) %>%
mutate(wetland = W_LU06_90+W_LU06_95)
dat = dat %>% dplyr::select(-W_BD_201,-W_BD_204,-W_BD_205,-W_BD_206,-W_BD_207,-W_BD_208,-W_BD_209,-W_BD_210,-W_BD_MISSI,
-W_BR_2,-W_BR_3,-W_BR_MISSI,-W_QG_3,-W_QG_4,-W_QG_6,-W_QG_7,-W_QG_8,-W_QG_9,-W_QG_10,
-W_QG_11,-W_QG_12,-W_QG_13,-W_QG_14,-W_QG_15,-W_QG_16,-W_QG_17,-W_QG_18,-W_QG_20,
-W_QG_21,-W_QG_22,-W_QG_24,-W_QG_29,-W_QG_99,-W_QG_MISSI,-W_LU06_23,-W_LU06_24,-W_LU06_31,
-W_LU06_MIS,-W_TEMP_ANN,-W_TEMP_GS,-W_TEMP_JUL,-W_PRCP_ANN)
#remove 2011 landcover (keeping 2006)
dat = dat %>% select(everything(),-contains("LU11"))
dat = dat %>% mutate(W_LA_Ratio = W_AREA/SHAPE_AREA)
#remove data that is 50% zero values
dat <- dat %>% select(-W_BD_202,-W_BR_1,-W_BR_41,-W_BR_42,-W_QG_2,-W_QG_5)
summary(dat)
#get Ca and Mg Data
CaMg <- read_csv("data/CaMg.csv")
dat_cations <- CaMg %>% select(WBIC,CaConcentration,MgConcentration) %>%
mutate(cation_ratio = CaConcentration/MgConcentration)
dat <- dat %>% left_join(dat_cations)
#get Conductivity data
Conductivity_final <- read_csv("data/Conductivity_final.csv")
dat_cond <- Conductivity_final %>% select(WBIC,final_value) %>% rename(cond=final_value)
dat <- dat %>% left_join(dat_cond)
#get elevation data
lake_elevation <- read_excel("data/seepage_lake_shed_elev.xlsx")
dat_elevation <- lake_elevation %>% select(WBIC,lake_MEAN,watershed_MIN,watershed_MAX,watershed_MEAN,elevation_difference)
dat <- dat %>% left_join(dat_elevation)
#get process data
HLM_out <- read_csv("GW_Models/HLM_out.csv") %>% rename(process_slope=slope)
dat <- dat %>% left_join(HLM_out)
#get HUC data
lagoscrosswalk <- read_csv("lagoscrosswalk.csv") %>% select(WIBIC,lagoslakeid,County) %>%
rename(WBIC=WIBIC)
lagoscrosswalk <- lagoscrosswalk[!duplicated(lagoscrosswalk$WBIC),]
dat <- dat %>% left_join(lagoscrosswalk)
#get ecoregion data
regression_coefs_20180328_eco_land <- read_excel("data/regression_coefs_20180328_eco_land.xlsx")
regression_coefs_20180328_eco_land <- regression_coefs_20180328_eco_land[!duplicated(regression_coefs_20180328_eco_land$WBIC),] %>%
select(-WiscID)
dat <- dat %>% left_join(regression_coefs_20180328_eco_land)
#cleanup data
rm(list=setdiff(ls(), "dat"))
refcols <- c("WBIC",
"WiscID",
"lagoslakeid",
"County",
"LakeName",
"US_L3NAME",
"ECO_LANDSC")
respcols <- c("slope",
"n.points",
"sd.slope",
"mape",
"Gnet",
"process_slope")
dat <- dat[,c(refcols,respcols,setdiff(names(dat),c(refcols,respcols)))]
write_csv(dat,"data/ecocontext.csv")
dat.gnet <- read_csv("data/Gnet_slopes.csv")
eco <- read_csv("data/ecocontext.csv")
dat.gnet <- dat.gnet %>% left_join(eco)
dat.gnet$WBIC <- factor(dat.gnet$WBIC,levels=dat.gnet$WBIC[order(dat.gnet$mean)]) #Code to order gnet variables for plotting
dat.gnet <- dat.gnet %>% mutate(slope_group = as.numeric(slope_group)) %>%
mutate(slope_group = replace(slope_group,which(mean < -1.626692 & slope_group==0),2))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group) ))
WI <- map_data(map = "state",region = "wisconsin")
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group) ))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group) )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1.5 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
rgb(117,112,179,200,maxColorValue = 255)))
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1.5 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1.5 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
WI.cty <- map_data(map = "county",region = "wisconsin")
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1.5 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1.1 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group) )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=.5)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=1)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=0.8)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=0.6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=0.5)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=0.1)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=0.8)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group) )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=0.1 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group),size=3 )) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group)),size=3) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggsave(filename = "graphics/gnet_map.png",units="in",dpi=300)
dat.gnet$WiscID <- factor(dat.gnet$WiscID,levels=dat.gnet$WiscID[order(dat.gnet$mean)]) #Code to order gnet variables for plotting
dat.gnet <- dat.gnet %>% mutate(slope_group = as.numeric(slope_group)) %>%
mutate(slope_group = replace(slope_group,which(mean < -1.626692 & slope_group==0),2))
#Ordered plot of Gnet
ggplot(data = dat.gnet,aes(x=WBIC,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WBIC",y="Gnet (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
#Ordered plot of Gnet
ggplot(data = dat.gnet,aes(x = WiscID,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WBIC",y="Gnet (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
#Ordered plot of Gnet
ggplot(data = dat.gnet,aes(x = WiscID,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WiscID",y="Gnet (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggplot() +
geom_polygon(data = WI, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = WI.cty, aes(x=long, y = lat, group = group), fill = NA, color = "darkgrey") +
coord_fixed(1.3) +
geom_point(data = dat.gnet,aes(x =long,y=lat,color=as.factor(slope_group)),size=3) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,200,maxColorValue = 255),
rgb(217,95,2,200,maxColorValue = 255),
rgb(117,112,179,200,maxColorValue = 255)))
ggsave(filename = "graphics/gnet_map.png",units="in",dpi=300)
#Ordered plot of Gnet
ggplot(data = dat.gnet,aes(x = WiscID,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WiscID",y="Groundwater Recharge (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggsave(filename = "graphics/gnet_by_gnet.png",units = "in",dpi = 300,width=8,height=5)
#Ordered plot of Gnet
ggplot(data = dat.gnet,aes(x = WiscID,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WiscID",y="Groundwater Recharge (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggsave(filename = "graphics/gnet_by_gnet.png",units = "in",dpi = 300,width=8,height=5)
names(dat.gnet)
dat.box <- dat.gnet[,c(5,18:58)]
dat.box.long <- dat.box %>% gather(key = "key",value = "value",-slope_group)
View(dat.box.long)
ggplot(data = dat.box.long,aes(y=value)) + geom_boxplot() + facet_wrap()
ggplot(data = dat.box.long,aes(y=value)) + geom_boxplot() + facet_wrap(vars(key))
ggplot(data = dat.box.long,aes(y=value)) + geom_boxplot() + facet_wrap(vars(key),scales = "free_y")
ggplot(data = dat.box.long,aes(x=slope_group, y=value)) + geom_boxplot() + facet_wrap(vars(key),scales = "free_y")
ggplot(data = dat.box.long) + geom_boxplot(x=as.factor(slope_group),y=value) + facet_wrap(vars(key),scales = "free")
ggplot(data = dat.box.long) + geom_boxplot(x=slope_group,y=value) + facet_wrap(vars(key),scales = "free")
ggplot(data = dat.box.long) + geom_boxplot(aes(x=slope_group,y=value)) + facet_wrap(vars(key),scales = "free")
ggplot(data = dat.box.long) + geom_boxplot(aes(x=as.factor(slope_group),y=value)) + facet_wrap(vars(key),scales = "free")
ggplot(data = dat.box.long) + geom_boxplot(aes(x=as.factor(slope_group),y=value,color=slope_group)) + facet_wrap(vars(key),scales = "free")
ggplot(data = dat.box.long) +
geom_boxplot(aes(x=as.factor(slope_group),y=value,color=as.factor(slope_group))) +
facet_wrap(vars(key),scales = "free")
ggplot(data = dat.box.long) +
geom_boxplot(aes(x=as.factor(slope_group),y=value,color=as.factor(slope_group))) +
facet_wrap(vars(key),scales = "free") +
theme(text=element_text(size=10,  family="sans")) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
dat.box <- dat.gnet[,c(5,18:58)] %>% mutate(SHAPE_AREA = log10(SHAPE_AREA))
dat.box.long <- dat.box %>% gather(key = "key",value = "value",-slope_group)
ggplot(data = dat.box.long) +
geom_boxplot(aes(x=as.factor(slope_group),y=value,color=as.factor(slope_group))) +
facet_wrap(vars(key),scales = "free") +
theme(text=element_text(size=10,  family="sans")) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
#BoxPlots
dat.box <- dat.gnet[,c(5,18:58)] %>% mutate(SHAPE_AREA = log10(SHAPE_AREA)) %>%
mutate(W_LA_Ratio = sqrt(W_LA_Ratio))
dat.box.long <- dat.box %>% gather(key = "key",value = "value",-slope_group)
ggplot(data = dat.box.long) +
geom_boxplot(aes(x=as.factor(slope_group),y=value,color=as.factor(slope_group))) +
facet_wrap(vars(key),scales = "free") +
theme(text=element_text(size=10,  family="sans")) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggsave(filename = "graphics/gnet_boxplots.png",units = "in",dpi = 300)
dat.gnet$WiscID <- factor(dat.gnet$WiscID,levels=dat.gnet$WiscID[order(dat.gnet$cond)]) #Code to order gnet variables for plotting
dat.gnet <- dat.gnet %>% mutate(slope_group = as.numeric(slope_group)) %>%
mutate(slope_group = replace(slope_group,which(mean < -1.626692 & slope_group==0),2))
#Ordered plot of Gnet
ggplot(data = dat.gnet,aes(x = WiscID,y=mean,color=as.factor(slope_group))) +
geom_hline(yintercept = -1.626692,col="blue") +
geom_hline(yintercept = -1.24984,col="blue")+
geom_point() +
geom_errorbar(aes(ymin=ll,ymax=ul)) +
labs(x="WiscID",y="Groundwater Recharge (mm/d)", color="Lake Group") +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(angle = 90, hjust = 1,size=6)) +
scale_color_manual(name="Lake Group",
labels=c("Low Recharge","Regional Average","High Recharge"),
values=c(rgb(27,158,119,255,maxColorValue = 255),
rgb(217,95,2,255,maxColorValue = 255),
rgb(117,112,179,255,maxColorValue = 255)))
ggsave(filename = "graphics/gnet_by_cond.png",units = "in",dpi = 300,width=8,height=5)
